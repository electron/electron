<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>Hello World!</title>
</head>

<body>
  <script>
    const { ipcRenderer } = require('electron')

    let handle = null;
    let sent = false;
    window.document.onpaste = async (event) => {
      const fileItem = event.clipboardData.items[0];
      handle = await fileItem.getAsFileSystemHandle();
      if (!sent) {
        if (handle.kind === 'file') {
          ipcRenderer.send('did-create-file-handle');
        } else {
          ipcRenderer.send('did-create-directory-handle');
        }
        sent = true;
      }
    };
  </script>
</body>

</html>